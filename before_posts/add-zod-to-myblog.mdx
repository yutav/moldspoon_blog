import { Layout } from 'lib/components'
import { Button } from '@geist-ui/core'
import ShareButton from "lib/components/original/parts/ShareButtons"
import TagLinks from "lib/components/original/parts/TagLinks"

import { useRouter } from 'next/router'

import MdxImage from "lib/components/original/parts/MdxImage"

export const meta = {
  title: 'Next.jsプロジェクト+Zodで楽々バリデーション',
  date: '2023-08-03T0:30:00.000Z',
  tags: [
    'Next.js',
    'Blog',
    'Vercel',
    'Zod',
    'バリデーション',
    'フロントエンド',
    'プログラミング'
  ]
}

<TagLinks tags={meta.tags} />

こんにちは、[yuku_tas](https://twitter.com/yuku_tas)です。

### 本記事のゴール

Next.jsプロジェクトに、サクッとバリデーションを追加したい。

### 作業

今回は友人から [zod](https://zod.dev/)がいいぞ、という話を聞いていたので迷わず試してみようと思いました。

今回は、
- price という項目に、**入力有無**と**整数値**のバリデーションを追加し、
- 入力が失敗するときはエラーメッセージを出す
- 入力が失敗するときは送信ボタンを押せなくしたい。
- **これ単体ではフォームバリデーションができない**ので、一番採用事例の多く`A first-party Zod resolver for React Hook Form.
`とzodのドキュメントにも書かれている[React Hook Form](https://github.com/react-hook-form/resolvers#zod)を使う。

という条件で進めてみます。
zodのドキュメント[Basic Usage](https://zod.dev/?id=basic-usage)あたりをヒントに使います。

#### zodをinstall

まず、Next.jsのプロジェクトルートで以下を打ちます。
```
yarn add zod react-hook-form
```

インストールが完了したら、
1. 対象のComponentでライブラリをインポート。
2. バリデーション定義を`zod`で書く。
3. フォーム管理を`react-hook-form`に一任する処理を書く。
4. Next.jsのjsxで書かれたフォーム処理に、`react-hook-form`のバリデーション処理、エラー表示処理を追加していく。

という流れとなります。

完成したソースコードのサンプルを以下に書きます（前述の1〜４の手順をコメントで追加していきます。）


```

```

### まとめ

こういうのってその言語・フレームワークばっかり使ってると手癖で覚えていくもんだよなーと思います。
そうじゃないと、いちいちググんないとダメですね...

この記事が何かのお役に立てれば幸いです。
最後までお読みいただきありがとうございました！

export default function Page({ children }) {
  const router = useRouter();
  const currentUrl = typeof window !== 'undefined' ? window.location.href : '';
  return (
    <Layout meta={meta}>
      <>
        {children}
        <ShareButton url={currentUrl} title={meta.title} />
      </>
    </Layout>
  )
}
